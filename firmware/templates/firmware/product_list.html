{% extends "firmware/base.html" %}

{% block content %}

<div class="container">
  <div class="expandable-boxes">
    {% for product in products %}
      <div class="expandable-box">
         <h2>{{ product.name }}</h2>
         <h6>
          {% for fg in product.fgs.all %}
            {% if forloop.last %}
              {{fg}}
            {% else %}
              {{fg}},
            {% endif %}
          {% endfor %}
        </h6>
        <ul class="list-group firmwares">
            
          {% for version in product.fgs.all.0.version_set.all|dictsortreversed:"number" %}

          <a href="{% if not version.hotfix %}{{ product.brand.base_url }}{% endif %}{{ version.download_page }}" target="_blank" class="list-group-item list-group-item-action flex-column align-items-start list-group-item {% if version.hotfix %}list-group-item-danger{% else %}list-group-item-success{% endif %}">
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1">{{version.number}}   {{version.name}}</h5>
              <small>Last Seen: {{ version.date_last_seen }}</small>
            </div>
            <div class="d-flex w-100 justify-content-between">
              {% if version.read_me %}
                <textarea style="min-width: 100%" rows="6">{{version.read_me}}</textarea>
              {% endif %}
            </div>
          </a>
            
          {% endfor %}

        </ul>
      </div>
    {% endfor %}
  </div>
</div>

{% endblock %}

{% block extrajs %}
<script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>

<script>
$(document).ready(function() {
    $('.firmwares').hide()
    $('.expandable-box').click(function(e) {
      if($(this).hasClass('open')) {
        $('.expandable-box.out').not($(this)).removeClass('out');
        $(this).removeClass('open');
        $('.firmwares').not($(this)).hide()
        $('.expandable-box').not($(this)).show()
      } else {
        $('.expandable-box').not($(this)).hide()
        $('.expandable-box').not($(this)).addClass('out');
        $('.firmwares').not($(this)).show()
        $(this).addClass('open');
      }
    });
  });
</script>
{% endblock %}