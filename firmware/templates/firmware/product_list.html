{% extends "firmware/base.html" %}

{% block content %}

<div class="container">
  <div class="expandable-boxes">
    {% for product in products %}
      <div class="expandable-box">
         <h2>{{ product.name }}</h2>
         <h6>
          {% for fg in product.fgs.all %}
            {% if forloop.last %}
              {{fg}}
            {% else %}
              {{fg}},
            {% endif %}
          {% endfor %}
        </h6>
        <div class="list-group firmwares" style="display:none;">
            
          {% for version in product.fgs.all.0.version_set.all|dictsortreversed:"number" %}
          <a href="{% if not version.hotfix %}{{ product.brand.base_url }}{% endif %}{{ version.download_page }}" target="_blank" class="list-group-item {% if version.hotfix %}list-group-item-danger{% else %}list-group-item-success{% endif %}">
            {{version.number}}   {{version.name}}
          </a>
            {% if version.read_me %}
              <textarea rows="6">{{version.read_me}}</textarea>
            {% endif %}
          {% endfor %}

      </div>
      </div>
    {% endfor %}
  </div>
</div>

{% endblock %}

{% block extrajs %}
<script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>

<script>
$(document).ready(function() {
    $('.expandable-box').click(function(e) {
      if($(this).hasClass('open')) {
        $('.expandable-box.out').not($(this)).removeClass('out');
        $(this).removeClass('open');
        $('.firmwares').not($(this)).hide()
      }
      else {
        $('.expandable-box').not($(this)).addClass('out');
        $('.firmwares').not($(this)).show()
        $(this).addClass('open');
      }
    });
  });
</script>
{% endblock %}